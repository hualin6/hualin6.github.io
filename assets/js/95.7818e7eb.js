(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{621:function(s,t,e){"use strict";e.r(t);var a=e(3),n=Object(a.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"windows-wsl上安装ubuntu系统安装指南"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#windows-wsl上安装ubuntu系统安装指南"}},[s._v("#")]),s._v(" Windows WSL上安装Ubuntu系统安装指南")]),s._v(" "),e("p",[s._v("适用于 Linux 的 Windows 子系统可供在 Windows Server 2019（版本 1709）和更高版本上安装。 本指南将指导你完成在计算机上启用 WSL 的步骤。")]),s._v(" "),e("h1",{attrs:{id:"wsl安装-wsl上安装ubuntu系统"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#wsl安装-wsl上安装ubuntu系统"}},[s._v("#")]),s._v(" WSL安装，WSL上安装Ubuntu系统")]),s._v(" "),e("p",[s._v("官方文档连接：https://docs.microsoft.com/zh-cn/windows/wsl/install-win10")]),s._v(" "),e("h2",{attrs:{id:"首先是在控制面板开启相关功能"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#首先是在控制面板开启相关功能"}},[s._v("#")]),s._v(" 首先是在控制面板开启相关功能")]),s._v(" "),e("p",[s._v("先要在设置里面开启开发者选项：")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210203171815174.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzODc4MzI0,size_16,color_FFFFFF,t_70",alt:""}})]),s._v(" "),e("p",[s._v("在控制面板->程序里面点击启用或关闭Windows功能：")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210203171918322.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzODc4MzI0,size_16,color_FFFFFF,t_70",alt:""}})]),s._v(" "),e("p",[s._v("打开了一个窗口，拖到最后，把这两个打上勾：")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210203172125339.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzODc4MzI0,size_16,color_FFFFFF,t_70",alt:""}})]),s._v(" "),e("p",[s._v("点击确定，等它处理完，可能要重启一次。")]),s._v(" "),e("h3",{attrs:{id:"启用wsl2-这一步也可以省略-不过还是建议开启wsl2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启用wsl2-这一步也可以省略-不过还是建议开启wsl2"}},[s._v("#")]),s._v(" 启用WSL2，这一步也可以省略，不过还是建议开启WSL2")]),s._v(" "),e("p",[e("strong",[s._v("下载内核包（WSL2运行的是真正的linux内核）：")]),s._v("\n连接："),e("a",{attrs:{href:"https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi",target:"_blank",rel:"noopener noreferrer"}},[s._v("适用于 x64 计算机的 WSL2 Linux 内核更新包"),e("OutboundLink")],1)]),s._v(" "),e("p",[s._v("下载完点击安装即可。")]),s._v(" "),e("p",[e("strong",[s._v("将 WSL 2 设置为默认版本：")]),s._v("\ncmd或者PowerShell运行命令： wsl --set-default-version 2")]),s._v(" "),e("h2",{attrs:{id:"启用适用于-linux-的-windows-子系统"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启用适用于-linux-的-windows-子系统"}},[s._v("#")]),s._v(" 启用适用于 Linux 的 Windows 子系统")]),s._v(" "),e("p",[s._v("必须启用“适用于 Linux 的 Windows 子系统”可选功能并重启，然后才能在 Windows 上运行 Linux 发行版。")]),s._v(" "),e("p",[s._v("以管理员身份打开 PowerShell 并运行：")]),s._v(" "),e("div",{staticClass:"language-powershell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("Enable-WindowsOptionalFeature")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Online "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("FeatureName Microsoft"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Windows"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Subsystem"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Linux\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"下载-linux-分发版"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#下载-linux-分发版"}},[s._v("#")]),s._v(" 下载 Linux 分发版")]),s._v(" "),e("p",[s._v("按照"),e("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows/wsl/install-manual",target:"_blank",rel:"noopener noreferrer"}},[s._v("这些说明"),e("OutboundLink")],1),s._v("下载你最喜爱的 Linux 发行版。")]),s._v(" "),e("h2",{attrs:{id:"提取并安装-linux-分发版"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#提取并安装-linux-分发版"}},[s._v("#")]),s._v(" 提取并安装 Linux 分发版")]),s._v(" "),e("p",[s._v("下载 Linux 分发版后，若要提取其内容并进行手动安装，请执行以下步骤：")]),s._v(" "),e("h3",{attrs:{id:"方式一-使用命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#方式一-使用命令"}},[s._v("#")]),s._v(" 方式一：使用命令")]),s._v(" "),e("ol",[e("li",[s._v("使用 PowerShell 提取 "),e("code",[s._v("<distro>.appx")]),s._v(" 包的内容：")])]),s._v(" "),e("div",{staticClass:"language-powershell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("Rename-Item")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\\Ubuntu"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("appx "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\\Ubuntu"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("zip\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("Expand-Archive")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\\Ubuntu"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("zip "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\\Ubuntu\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[s._v("在目标文件夹中运行分发版启动器应用程序。 启动器通常命名为 "),e("code",[s._v("<distro>.exe")]),s._v("（例如，"),e("code",[s._v("ubuntu.exe")]),s._v("）。"),e("img",{attrs:{src:"https://docs.microsoft.com/zh-cn/windows/wsl/media/server-appx-expand.png",alt:""}})])]),s._v(" "),e("blockquote",[e("p",[s._v("注意")]),s._v(" "),e("p",[e("strong",[s._v("安装失败并出现错误 0x8007007e")]),s._v("：如果收到此错误，则表明系统不支持 WSL。 请确保运行的是 Windows 版本 16215 或更高版本。 "),e("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows/wsl/troubleshooting#check-your-build-number",target:"_blank",rel:"noopener noreferrer"}},[s._v("检查内部版本"),e("OutboundLink")],1),s._v("。 另外，请进行检查以"),e("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows/wsl/troubleshooting#confirm-wsl-is-enabled",target:"_blank",rel:"noopener noreferrer"}},[s._v("确认 WSL 已启用"),e("OutboundLink")],1),s._v("，并且在启用此功能后重新启动了计算机。")])]),s._v(" "),e("ol",{attrs:{start:"3"}},[e("li",[s._v("使用 PowerShell 将你的分发版路径添加到 Windows 环境路径（在本例中为 "),e("code",[s._v("C:\\Users\\Administrator\\Ubuntu")]),s._v("）：")])]),s._v(" "),e("div",{staticClass:"language-powershell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userenv")]),s._v(" = "),e("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[System.Environment]")]),s._v("::GetEnvironmentVariable"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Path"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"User"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[System.Environment]")]),s._v("::SetEnvironmentVariable"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"PATH"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userenv")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('";C:\\Users\\Administrator\\Ubuntu"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"User"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("现在，可以通过键入 "),e("code",[s._v("<distro>.exe")]),s._v(" 从任何路径启动你的分发版。 例如： "),e("code",[s._v("ubuntu.exe")]),s._v("。")]),s._v(" "),e("p",[s._v("安装了分发版后，必须先"),e("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows/wsl/install-win10",target:"_blank",rel:"noopener noreferrer"}},[s._v("初始化新的分发版实例"),e("OutboundLink")],1),s._v("，然后才能使用它。")]),s._v(" "),e("h3",{attrs:{id:"方式二-普通操作方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#方式二-普通操作方法"}},[s._v("#")]),s._v(" 方式二：普通操作方法")]),s._v(" "),e("p",[s._v("直接将下载的的Ubuntu.appx 修改为Ubuntu.zip，然后解压，进入解压后目录运行Ubuntu.exe即可，2004的是"),e("code",[s._v("ubuntu2004.exe")])]),s._v(" "),e("hr"),s._v(" "),e("h1",{attrs:{id:"为新的-linux-分发版创建用户帐户和密码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#为新的-linux-分发版创建用户帐户和密码"}},[s._v("#")]),s._v(" 为新的 Linux 分发版创建用户帐户和密码")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows/wsl/install-win10",target:"_blank",rel:"noopener noreferrer"}},[s._v("启用 WSL 并从 Microsoft Store 中安装 Linux 分发版"),e("OutboundLink")],1),s._v("后，在打开新安装的 Linux 分发版时将会要求你完成的第一步是创建帐户，包括 "),e("strong",[s._v("用户名")]),s._v(" 和 "),e("strong",[s._v("密码")]),s._v("。")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("此 "),e("strong",[s._v("用户名")]),s._v(" 和 "),e("strong",[s._v("密码")]),s._v(" 特定于安装的每个单独的 Linux 分发版，与 Windows 用户名无关。")])]),s._v(" "),e("li",[e("p",[s._v("创建 "),e("strong",[s._v("用户名")]),s._v(" 和 "),e("strong",[s._v("密码")]),s._v(" 后，该帐户将是分发版的默认用户，并将在启动时自动登录。")])]),s._v(" "),e("li",[e("p",[s._v("此帐户将被视为 Linux 管理员，能够运行 "),e("code",[s._v("sudo")]),s._v(" (Super User Do) 管理命令。")])]),s._v(" "),e("li",[e("p",[s._v("在适用于 Linux 的 Windows 子系统上运行的每个 Linux 分发版都有其自身的 Linux 用户帐户和密码。 每当添加分发版、重新安装或重置时，都必须配置一个 Linux 用户帐户。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://docs.microsoft.com/zh-cn/windows/wsl/media/ubuntuinstall.png",alt:""}})]),s._v(" "),e("h2",{attrs:{id:"更新和升级包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#更新和升级包"}},[s._v("#")]),s._v(" 更新和升级包")]),s._v(" "),e("p",[s._v("大多数分发版随附了一个空的的包目录或最简单的包目录。 我们强烈建议定期更新包目录并使用分发版的首选包管理器升级已安装的包。 对于 Debian/Ubuntu，请使用 apt：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" update "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" upgrade\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("Windows 不会自动更新或升级 Linux 分发版。 大多数 Linux 用户往往倾向于自行控制此任务。")]),s._v(" "),e("h2",{attrs:{id:"重置-linux-密码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#重置-linux-密码"}},[s._v("#")]),s._v(" 重置 Linux 密码")]),s._v(" "),e("p",[s._v("若要更改密码，请打开 Linux 分发版（例如 Ubuntu）并输入以下命令："),e("code",[s._v("passwd")])]),s._v(" "),e("p",[s._v("系统会要求你输入当前密码，然后要求输入新密码，之后再确认新密码。")]),s._v(" "),e("h2",{attrs:{id:"忘记密码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#忘记密码"}},[s._v("#")]),s._v(" 忘记密码")]),s._v(" "),e("p",[s._v("如果忘记了 Linux 分发版的密码：")]),s._v(" "),e("p",[s._v("方式一：")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("请打开 PowerShell，并使用以下命令进入默认 WSL 分发版的根目录："),e("code",[s._v("wsl -u root")])]),s._v(" "),e("blockquote",[e("p",[s._v("如果需要在非默认分发版中更新忘记的密码，请使用命令："),e("code",[s._v("wsl -d Debian -u root")]),s._v("，并将 "),e("code",[s._v("Debian")]),s._v(" 替换为目标分发版的名称。")])])]),s._v(" "),e("li",[e("p",[s._v("在 PowerShell 内的根级别打开 WSL 发行版后，可使用此命令更新密码："),e("code",[s._v("passwd <WSLUsername>")]),s._v("，其中 "),e("code",[s._v("<WSLUsername>")]),s._v(" 是 DISTRO 中帐户的用户名，而你忘记了它的密码。")])]),s._v(" "),e("li",[e("p",[s._v("系统将提示你输入新的 UNIX 密码，然后确认该密码。 在被告知密码已成功更新后，请使用以下命令在 PowerShell 内关闭 WSL："),e("code",[s._v("exit")])])])]),s._v(" "),e("blockquote",[e("p",[s._v("备注")]),s._v(" "),e("p",[s._v("如果运行的是早期版本的 Windows 操作系统，例如 1703（创意者更新）或 1709 (Fall Creators Update)，请参阅"),e("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows/wsl/user-support-archived",target:"_blank",rel:"noopener noreferrer"}},[s._v("此用户帐户更新文档的存档版本"),e("OutboundLink")],1),s._v("。")])])])]),s._v(" "),e("p",[s._v("方式二：")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("设置 Ubuntu 默认以 root 用户登录，打开 CMD 输入：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("ubuntu config --default-user root\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("打开 Ubuntu，用 passwd root 命令设置 root 用户密码；")]),s._v(" "),e("p",[s._v("若要设置默认以普通用户身份登录 Ubuntu：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("ubuntu config --default-user username\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])]),s._v(" "),e("h1",{attrs:{id:"wsl常用命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#wsl常用命令"}},[s._v("#")]),s._v(" wsl常用命令：")]),s._v(" "),e("p",[s._v("cmd下查看已安装的WSL命令：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("wsl -l \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#或者")]),s._v("\nwsl -l -v\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210203165616974.png",alt:""}})]),s._v(" "),e("p",[s._v("注销（卸载，但是文件需要手动删除）已安装的子系统：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("wslconfig /u <安装的分发版的名字>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210203170029905.png",alt:""}})]),s._v(" "),e("p",[s._v("关闭、启动 WSL，子系统重启，实际上是重启windows上对应的服务：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#关闭")]),s._v("\nnet stop LxssManager\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动")]),s._v("\nnet start LxssManager\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("注意需要管理员权限。")]),s._v(" "),e("h1",{attrs:{id:"ssh连接win-ubuntu-使用ssh终端连接wsl"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ssh连接win-ubuntu-使用ssh终端连接wsl"}},[s._v("#")]),s._v(" ssh连接win ubuntu_使用SSH终端连接WSL")]),s._v(" "),e("ol",[e("li",[s._v("获得Ubuntu系统的IP：")])]),s._v(" "),e("p",[s._v("【开始】中，启动Ubuntu18.04，在wsl窗口中，执行：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("ifconfig\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("eth0:段中的inet后的 "),e("strong",[s._v("172.17.86.219")]),s._v(" ，即为本机的IP地址("),e("em",[s._v("每次启动wsl，获得新地址，后面建立连接用到")]),s._v(")")]),s._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[s._v("启动SSH 服务")])]),s._v(" "),e("p",[s._v("wsl窗口中，执行：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo service ssh start\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("启动ssh server，如果出错或报没有此命令，则需安装SSH server，参考"),e("strong",[s._v("安装SSH。")])]),s._v(" "),e("p",[s._v("检查是否成功")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo service ssh status\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("安装SSH")])]),s._v(" "),e("ul",[e("li",[e("p",[s._v("1.先更新系统包")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" update\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" upgrade\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("2.安装SSH服务")])])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" remove openssh-server\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" openssh-server\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("ul",[e("li",[s._v("3.修改配置文件")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/ssh/sshd_config\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("主要改两项：")]),s._v(" "),e("p",[s._v("Port: 22 把前面的#注释去掉，紧接的几行也可以去掉#")]),s._v(" "),e("p",[s._v("PasswordAuthentication yes 把no改为yes")]),s._v(" "),e("ul",[e("li",[s._v("4.重新启动ssh")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" restart\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"下载工具"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#下载工具"}},[s._v("#")]),s._v(" 下载工具")]),s._v(" "),e("p",[e("strong",[s._v("MobaXterm")])]),s._v(" "),e("p",[s._v("下载地址： https://mobaxterm.mobatek.net/download-home-edition.html")]),s._v(" "),e("p",[s._v("选择免安装版(Portable Edition)下载。")]),s._v(" "),e("p",[s._v("第一次运行，会自动检测到WSL")]),s._v(" "),e("p",[e("strong",[s._v("MobaXterm会自动检测到WSL环境，直接点击左侧图标，输入用户名、密码，即可快速连接")]),s._v("*。但下面介绍更一般的用法，"),e("strong",[s._v("手工建立会话连接")]),s._v("，这也适用于连接其他计算机上的Linux系统。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/a6b4246d0c20492809128bb15cb34cd5.png",alt:""}})]),s._v(" "),e("p",[s._v("如上图，点击左上角【Session】，打开如下界面")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/948f31b04555b4d2c98a2654a1e80857.png",alt:""}})]),s._v(" "),e("p",[s._v("输入IP，wsl用户名")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/4eedf28f369b36519ccec73d6940d975.png",alt:""}})]),s._v(" "),e("p",[s._v("如果出现Network errror:Connection refused，表示ssh设置有问题")]),s._v(" "),e("p",[s._v("出现类似问题，可参考"),e("strong",[s._v("准备工作")]),s._v("中的说明，检查一下ssh的启动状态。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/cb04fe83c38644a835e1cbfb63ee1752.png",alt:""}})]),s._v(" "),e("p",[s._v("连接上，等待输入登录密码")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/f9373e8d10195059b825773a803b5a95.png",alt:""}})]),s._v(" "),e("p",[s._v("选择【Yes】后，出现加密方式保存Ubuntu用户密码界面，加密密码至少为7位。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/cbb3fdc0ce5b7eb96b4bdf06f4b41144.png",alt:""}})]),s._v(" "),e("p",[s._v("加密密码至少长为7位")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/5fd36671ab50fc7d31e266127af7881d.png",alt:""}})]),s._v(" "),e("p",[s._v("连接成功")]),s._v(" "),e("p",[s._v("连接成功后，左侧为Ubuntu中的文件列表，可以在其中进行文件、目录操作。右侧为终端，可以在其中执行linux命令。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/5f76b06244716c995570601bb84b1ee7.png",alt:""}})]),s._v(" "),e("p",[s._v("Ubuntu与本地window间上传下载文件")]),s._v(" "),e("p",[s._v("以后每次启动WSL，可以在建立的连接上，鼠标右键，"),e("strong",[s._v("【Edit session】")]),s._v("，修改ip等参数。")]),s._v(" "),e("h3",{attrs:{id:"使用其他工具连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用其他工具连接"}},[s._v("#")]),s._v(" 使用其他工具连接")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("Xshell")])])]),s._v(" "),e("p",[s._v("下载地址： https://www.netsarang.com/en/free-for-home-school/")]),s._v(" "),e("p",[s._v("选择免费的个人版。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/10f9297ab95b166421400acf5ef6d847.png",alt:""}})]),s._v(" "),e("p",[s._v("下载页面注意选Both")]),s._v(" "),e("p",[s._v("会发送"),e("strong",[s._v("两封邮件到你的邮箱，一个是Xshell的链接，另一个是Xftp的链接")]),s._v("。Xftp为内嵌入Xshell中，用于文件传输，依次下载、安装。(因为下载的是个人免费版本，在首次启动Xshell后，会提问是否购买，【关闭】即可)。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/432fb336ab0aab98152496e8965c1e46.png",alt:""}})]),s._v(" "),e("p",[s._v("去掉启动显示")]),s._v(" "),e("p",[s._v("【新建】会话")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/6c32ec225fe75e13a09361899e66d3e5.png",alt:""}})]),s._v(" "),e("p",[s._v("输入ip")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/9641caea4c901a0a2174493c4780a2af.png",alt:""}})]),s._v(" "),e("p",[s._v("首次连接，会提问，【接受并保存】")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/76e161317fac5821881483688afc80c7.png",alt:""}})]),s._v(" "),e("p",[s._v("输入wsl的用户名、密码")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/7d7e5c11820e2f8215c11267cf3b7e30.png",alt:""}})]),s._v(" "),e("p",[s._v("连接成功")]),s._v(" "),e("p",[s._v("登录成功后，即可在"),e("strong",[s._v("右侧窗口执行linux命令，左侧会话列表中，选中一会话，鼠标右键【属性】中，可修改ip地址")]),s._v("。如果要传输文件，可"),e("strong",[s._v("点击下图中图标")]),s._v("，启动Xftp。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/95c25ae033340609e0d8904f9bcb8053.png",alt:""}})]),s._v(" "),e("p",[s._v("Xftp界面")]),s._v(" "),e("p",[s._v("左侧为本地文件窗口，右侧为Ubuntu中文件操作窗口。鼠标右键，选择对应操作。")]),s._v(" "),e("hr"),s._v(" "),e("p",[e("strong",[s._v("MobaXterm与Xshell对比")])]),s._v(" "),e("p",[s._v("MobaXterm可以自动检测WSL，建立连接比较方便。Xshell中的Xftp，相当于一个ftp客户端，文件的操作能力强大。")]),s._v(" "),e("hr"),s._v(" "),e("h1",{attrs:{id:"ubuntu设置国内源-提高下载速度"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ubuntu设置国内源-提高下载速度"}},[s._v("#")]),s._v(" Ubuntu设置国内源，提高下载速度")]),s._v(" "),e("p",[s._v("换源需要修改/etc/apt/sources.list文件，最好先备份：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /etc/apt/sources.list /etc/apt/sources.list.backup\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("随后进入修改/etc/apt/sources.list：")]),s._v(" "),e("p",[s._v("vim命令往下翻")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/apt/sources.list\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("将文件里的内容替换成阿里源：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("#阿里源\ndeb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse\ndeb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse\ndeb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse\ndeb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse\ndeb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse\ndeb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse\ndeb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse\ndeb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse\ndeb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse\ndeb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("p",[s._v("保存退出后执行以下命令更新源：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" upgrade\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("其它源：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("#清华源：\ndeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse\ndeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse\ndeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse\ndeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse\ndeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse\ndeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse\ndeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse\ndeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse\ndeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse\ndeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("#中科大源\ndeb https://mirrors.ustc.edu.cn/ubuntu/ bionic main restricted universe multiverse\ndeb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic main restricted universe multiverse\ndeb https://mirrors.ustc.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse\ndeb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse\ndeb https://mirrors.ustc.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse\ndeb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse\ndeb https://mirrors.ustc.edu.cn/ubuntu/ bionic-security main restricted universe multiverse\ndeb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-security main restricted universe multiverse\ndeb https://mirrors.ustc.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse\ndeb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("h1",{attrs:{id:"vim命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vim命令"}},[s._v("#")]),s._v(" VIM命令")]),s._v(" "),e("p",[s._v("在 Linux 中使用 vim 时，输入 "),e("code",[s._v("vim xxx.file")]),s._v(" 输入好文件内容之后，怎么保存呢？")]),s._v(" "),e("p",[s._v("按 ESC，左下角就可以进行输入")]),s._v(" "),e("p",[e("code",[s._v(":w")]),s._v(" 保存但不退出")]),s._v(" "),e("p",[e("code",[s._v(":wq")]),s._v(" 保存并退出")]),s._v(" "),e("p",[e("code",[s._v(":q")]),s._v(" 退出")]),s._v(" "),e("p",[e("code",[s._v(":q!")]),s._v(" 强制退出，不保存")]),s._v(" "),e("p",[e("code",[s._v(":e!")]),s._v(" 放弃所有修改，从上次保存文件开始再编辑命令历史")]),s._v(" "),e("hr"),s._v(" "),e("h1",{attrs:{id:"wsl启用systemd"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#wsl启用systemd"}},[s._v("#")]),s._v(" WSL启用systemd")]),s._v(" "),e("p",[s._v("WSL默认不是以systemd作为初始化进程，所以无法使用systemctl，使用systemctl时会出现以下提示：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("System has not been booted with systemd as init system (PID 1). Can't operate.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("先安装下daemonize")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" daemonize\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("编辑下/etc/profile")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/profile\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("添加如下内容：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SYSTEMD_PID=$(ps -ef | grep '/lib/systemd/systemd --system-unit=basic.target$' | grep -v unshare | awk '{print $2}')\n\nif [ -z \"$SYSTEMD_PID\" ]; then\n   sudo daemonize /usr/bin/unshare --fork --pid --mount-proc /lib/systemd/systemd --system-unit=basic.target\n   SYSTEMD_PID=$(ps -ef | grep '/lib/systemd/systemd --system-unit=basic.target$' | grep -v unshare | awk '{print $2}')\nfi\n\nif [ -n \"$SYSTEMD_PID\" ] && [ \"$SYSTEMD_PID\" != \"1\" ]; then\n    exec sudo /usr/bin/nsenter -t $SYSTEMD_PID -a su - $LOGNAME\nfi\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("p",[s._v("编辑/etc/sudoers")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/sudoers\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("添加如下内容：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("%sudo ALL=(ALL) NOPASSWD: /usr/sbin/daemonize /usr/bin/unshare --fork --pid --mount-proc /lib/systemd/systemd --system-unit=basic.target\n%sudo ALL=(ALL) NOPASSWD: /usr/bin/nsenter -t [0-9]* -a su - [a-zA-Z0-9]*\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("更新下配置文件，使刚刚编辑的内容生效：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /etc/profile\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("运行如下命令验证是否成功：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("systemctl --version\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("hr"),s._v(" "),e("h1",{attrs:{id:"wsl2-ubuntu图形界面安装与远程桌面"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#wsl2-ubuntu图形界面安装与远程桌面"}},[s._v("#")]),s._v(" WSL2 Ubuntu图形界面安装与远程桌面")]),s._v(" "),e("blockquote",[e("p",[s._v("WSL是不支持显示图形界面的，目前只支持命令行。WSL内部使用的是VM，运行真实的linux内核，所以可以运行KDE、Gnome、xfce、lxde等桌面环境的程序包，但是无法直接显示。据说微软会在后续退出WSL的图形界面，在目前，我们可以通过远程连接的方式来访问子系统的图形界面。")])]),s._v(" "),e("h2",{attrs:{id:"安装ubuntu桌面环境"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装ubuntu桌面环境"}},[s._v("#")]),s._v(" 安装Ubuntu桌面环境")]),s._v(" "),e("p",[s._v("可以根据自己的喜好安装 KDE、Gnome、xfce、lxde 等桌面环境。Gnome是 Ubuntu 的默认桌面上环境，也是多数发行版的默认桌面环境，我对 Gnome 更熟悉一点，所以这里以"),e("code",[s._v("Gnome")]),s._v("为例进行安装：\nWSL Ubuntu命令行输入：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo apt install ubuntu-desktop\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("安装其他桌面：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("#KDE\nsudo apt install kubuntu-desktop\n\n#Xfce\nsudo apt install xubuntu-desktop\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[s._v("其他桌面可以去百度，理论上Ubuntu系统可以装的桌面环境都可以在WSL2 Ubuntu上装。")]),s._v(" "),e("p",[s._v("安装完可能需要几分钟，中间按照提示操作就可以了。")]),s._v(" "),e("h2",{attrs:{id:"安装xrdp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装xrdp"}},[s._v("#")]),s._v(" 安装XRDP")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo apt install -y xrdp\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("xrdp服务会自动启动，可以通过以下命令查看：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo systemctl status xrdp\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("将xrdp添加到"),e("code",[s._v("sll-cert")]),s._v("用户组：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo adduser xrdp ssl-cert\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("重启 Xrdp 服务，让刚才的设置生效：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo systemctl restart xrdp\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"连接远程桌面"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#连接远程桌面"}},[s._v("#")]),s._v(" 连接远程桌面")]),s._v(" "),e("p",[s._v("先在子系统上运行以下命令，查看下虚拟机的IP地址")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("ip addr | grep eth0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210203234914597.png",alt:""}})]),s._v(" "),e("p",[s._v("上面选中的部分就是子系统虚拟机的 IP 地址，复制下来。")]),s._v(" "),e("blockquote",[e("p",[s._v("新版本的windows系统已经支持用localhost来访问子系统了，详见："),e("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows/wsl/compare-versions#accessing-linux-networking-apps-from-windows-localhost",target:"_blank",rel:"noopener noreferrer"}},[s._v("微软官网"),e("OutboundLink")],1)])]),s._v(" "),e("p",[s._v("win+R，运行mstsc：")]),s._v(" "),e("p",[s._v("输入刚刚复制的ip地址，端口号默认为3389：")]),s._v(" "),e("blockquote",[e("p",[s._v("如果你是Windows 18945以后的版本，可以直接输入"),e("code",[s._v("localhost:3389")]),s._v("，强烈建议更新下系统，不然每次子系统重启后都得"),e("code",[s._v("ip addr | grep eth0")]),s._v("重新获取IP地址。")])]),s._v(" "),e("p",[s._v("点击连接后如果出现错误提示弹窗，参见文末的问题排查1进行解决。\n输入登录的用户名密码:")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210204000011303.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzODc4MzI0,size_16,color_FFFFFF,t_70",alt:""}})]),s._v(" "),e("p",[s._v("如果不能正常显示如下桌面，尝试看看文尾的问题排查2。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/2021020418113053.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzODc4MzI0,size_16,color_FFFFFF,t_70",alt:""}})]),s._v(" "),e("blockquote",[e("p",[s._v("注意：wsl2暂时还不支持硬件加速绘图，所以你是在用cpu跑gnome图形界面，可能会比较卡。cpu不太给力的机器，甚至有可能进去后一片漆黑。")])]),s._v(" "),e("h2",{attrs:{id:"问题排查"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#问题排查"}},[s._v("#")]),s._v(" 问题排查")]),s._v(" "),e("p",[s._v("就一些常见问题给出相关解决办法：")]),s._v(" "),e("h5",{attrs:{id:"_1-远程桌面点击连接后显示连接失败"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-远程桌面点击连接后显示连接失败"}},[s._v("#")]),s._v(" 1. 远程桌面点击连接后显示连接失败：")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("如果弹窗说你正在运行一个控制台会话")]),s._v("，说明xrdp默认的3389端口已经被其他（控制台）应用占用了，尝试修改xrdp监听的端口"),e("code",[s._v("sudo vim /etc/xrdp/xrdp.ini")]),s._v("，修改文件中的port。")]),s._v(" "),e("li",[e("strong",[s._v("如果弹窗说无法连接到远程计算机")]),s._v("，IP地址不对或者xrdp没有正常运行。使用"),e("code",[s._v("ip addr | grep eth0")]),s._v("命令重新看下IP地址，因为每次WSL重启后IP地址都会变（Windows 18945 以上版本直接用localhost就好）。尝试"),e("code",[s._v("sudo systemctl restart xrdp")]),s._v("重启 xrdp 服务。")])]),s._v(" "),e("h5",{attrs:{id:"_2-可以连接-但是进去后桌面一片漆黑"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-可以连接-但是进去后桌面一片漆黑"}},[s._v("#")]),s._v(" 2. 可以连接，但是进去后桌面一片漆黑：")]),s._v(" "),e("ul",[e("li",[s._v("第一次进入桌面会比较卡，稍等一会看看")]),s._v(" "),e("li",[s._v("尝试重启wsl（cmd管理员运行："),e("code",[s._v("net stop LxssManager")]),s._v(" 和 "),e("code",[s._v("net start LxssManager")]),s._v("）")]),s._v(" "),e("li",[s._v("尝试"),e("code",[s._v("sudo apt install ubuntu-desktop")]),s._v("重新安装下桌面")])]),s._v(" "),e("h5",{attrs:{id:"_3-闪退"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-闪退"}},[s._v("#")]),s._v(" 3.闪退")]),s._v(" "),e("ul",[e("li",[s._v("应该是权限的问题，不要用root登录。")])]),s._v(" "),e("h2",{attrs:{id:"关于xrdp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#关于xrdp"}},[s._v("#")]),s._v(" 关于xrdp")]),s._v(" "),e("p",[s._v("xrdp 配置文件在/etc/xrdp目录。一般不需要对配置文件进行修改。\n使用"),e("code",[s._v("sudo vim /etc/xrdp/xrdp.ini")]),s._v("对配置文件进行修改。\n默认的端口号是3389。\nxrdp 使用startwm.sh文件启动 X 会话，可以通过编辑 "),e("code",[s._v("/etc/xrdp/startwm.sh")]),s._v("来使用其他X Window 桌面。")])])}),[],!1,null,null,null);t.default=n.exports}}]);