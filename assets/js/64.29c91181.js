(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{584:function(s,e,t){"use strict";t.r(e);var a=t(3),r=Object(a.a)({},(function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"docker运行项目-应用程序"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker运行项目-应用程序"}},[s._v("#")]),s._v(" Docker运行项目/应用程序")]),s._v(" "),t("p",[s._v("在运行应用程序之前，我们需要将应用程序源代码下载到我们的计算机上。对于实际项目，通常将克隆存储库,此处是直接下载一个压缩后的项目进行操作的.")]),s._v(" "),t("h3",{attrs:{id:"下载应用-项目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载应用-项目"}},[s._v("#")]),s._v(" 下载应用/项目")]),s._v(" "),t("p",[s._v("1.点击"),t("a",{attrs:{href:"http://localhost/assets/app.zip",target:"_blank",rel:"noopener noreferrer"}},[s._v("下载测试项目ZIP"),t("OutboundLink")],1),s._v("。解压ZIP文件。")]),s._v(" "),t("p",[s._v("2.使用Visual Studio Code或其他编辑器打开项目，如果项目根目录下没有一个Dockerfile 的文件，则新建此文件，没有"),t("code",[s._v(".xxx")]),s._v("结尾，直接就是Dockerfile ，Dockerfile只是用于创建容器镜像的基于文本的指令脚本。如果有这个文件则跳过这个步骤。")]),s._v(" "),t("h3",{attrs:{id:"构建应用程序的容器镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#构建应用程序的容器镜像"}},[s._v("#")]),s._v(" 构建应用程序的容器镜像")]),s._v(" "),t("p",[s._v("1.Dockerfile与package.json文件处于相同的文件夹，处于同级目录,新建后粘贴以下内容:")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" node"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("12"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("alpine\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /app\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" . .\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yarn install "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("production\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"src/index.js"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("2.构建容器镜像，在项目根目录打开终端，执行"),t("code",[s._v("docker build")]),s._v("命令构建容器镜像:")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("docker build -t getting-started "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("此命令使用Dockerfile构建新的容器镜像，您可能已经注意到下载了许多“镜像”，这是因为我们指示构建者要从"),t("code",[s._v("node:12-alpine")]),s._v(" 镜像开始。但是，由于我们的计算机上没有该镜像，因此需要下载该镜像。")]),s._v(" "),t("p",[s._v("下载镜像后，我们将其复制到应用程序/项目中并用于"),t("code",[s._v("yarn")]),s._v("安装应用程序的依赖项，该"),t("code",[s._v("CMD")]),s._v("指令指定从该镜像启动容器时要运行的默认命令。")]),s._v(" "),t("p",[s._v("最后，"),t("code",[s._v("-t")]),s._v("标志标记我们的镜像，可以简单地将其视为最终镜像的易于理解的名称，由于我们将镜像命名为"),t("code",[s._v("getting-started")]),s._v("，因此在运行容器时可以引用该镜像。")]),s._v(" "),t("p",[s._v("将"),t("code",[s._v(".")]),s._v("在"),t("code",[s._v("docker build")]),s._v("最后是命令告诉 Docker should应该寻找"),t("code",[s._v("Dockerfile")]),s._v("在当前目录。")]),s._v(" "),t("hr"),s._v(" "),t("h3",{attrs:{id:"启动应用程序容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动应用程序容器"}},[s._v("#")]),s._v(" 启动应用程序容器")]),s._v(" "),t("p",[s._v("1.使用"),t("code",[s._v("docker run")]),s._v("命令启动容器，并指定我们刚刚创建的镜像的名称：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("//简写\ndocker run -dp "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v(":3000 getting-started\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("blockquote",[t("p",[s._v("原命令： docker run -d -p 3000:3000 docker/getting-started")])]),s._v(" "),t("p",[s._v("还记得"),t("code",[s._v("-d")]),s._v("和"),t("code",[s._v("-p")]),s._v("标志吗？我们正在“分离”模式下（在后台）运行新容器，并将主机的端口3000到容器的端口3000之间创建映射。如果没有端口映射，我们将无法访问该应用程序。")]),s._v(" "),t("p",[s._v("2.运行之后,就可以打开Web浏览器到访问"),t("a",{attrs:{href:"http://localhost:3000/",target:"_blank",rel:"noopener noreferrer"}},[s._v("http:// localhost:3000"),t("OutboundLink")],1),s._v(" 的地址。您应该看到我们运行的应用程序！")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://imgchr.com/i/sMScFI",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"https://s3.ax1x.com/2021/01/09/sMScFI.jpg",alt:"sMScFI.jpg"}}),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("至此一个新的项目就跑起来了.")]),s._v(" "),t("p",[s._v("如果快速浏览Docker Dashboard，您应该会看到对应的容器在运行，端口为3000的那个")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://imgchr.com/i/sMSXlT",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"https://s3.ax1x.com/2021/01/09/sMSXlT.jpg",alt:"sMSXlT.jpg"}}),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("要想将创建的镜像共享，则需要Docker注册表，默认注册表是Docker Hub，这是我们使用过的所有镜像的来源。")]),s._v(" "),t("p",[s._v("要推送镜像，我们首先需要在Docker Hub上创建一个仓库。")]),s._v(" "),t("h3",{attrs:{id:"创建仓库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建仓库"}},[s._v("#")]),s._v(" 创建仓库")]),s._v(" "),t("ol",[t("li",[s._v("点击打开 "),t("a",{attrs:{href:"https://hub.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker Hub"),t("OutboundLink")],1),s._v(" 网站并登录。")]),s._v(" "),t("li",[s._v("登录后单击"),t("strong",[s._v("创建存储库")]),s._v("按钮。")])]),s._v(" "),t("p",[t("a",{attrs:{href:"https://imgchr.com/i/sMvVAI",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"https://s3.ax1x.com/2021/01/09/sMvVAI.jpg",alt:"登录到dockerhub并点击仓库仓库"}}),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("3.输入仓库名称，选择公开或私有，点击创建")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://imgchr.com/i/sMvvrQ",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"https://s3.ax1x.com/2021/01/09/sMvvrQ.jpg",alt:"创建仓库"}}),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("4.创建完成后就进入到新建的仓库了")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://imgchr.com/i/sMxmZ9",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"https://s3.ax1x.com/2021/01/09/sMxmZ9.jpg",alt:"sMxmZ9.jpg"}}),t("OutboundLink")],1)]),s._v(" "),t("ol",{attrs:{start:"5"}},[t("li",[t("p",[s._v("进入仓库后可以看到右侧的"),t("code",[s._v("Docker commands")]),s._v("  命令， 这个命令的是你需要运行该命令才能推送到这个仓库，现在复制命令到cmd执行")]),s._v(" "),t("div",{staticClass:"language-powershell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[s._v("docker push marklin9"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("getting"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("started:tagname\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("此时若直接回车会提示")]),s._v(" "),t("div",{staticClass:"language-powershell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[s._v("The push refers to repository "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[docker.io/marklin9/getting-started]")]),s._v("\nAn image does not exist locally with the tag: marklin9"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("getting"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("started\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("这是应为push时没有查找到"),t("code",[s._v("marklin9/getting-started")]),s._v(" 的镜像，此时需要标记我们已构建的现有镜像名")]),s._v(" "),t("p",[s._v("先登陆Docker Hub，在命令行输入` docker login -u marklin9， 输入密码，提示登录成功。")]),s._v(" "),t("div",{staticClass:"language-powershell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[s._v("E:\\Pro\\Docker\\app>docker login "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("u marklin9\nPassword: \nLogin Succeeded\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("登录后再次执行"),t("code",[s._v("docker tag getting-started marklin9/getting-started")]),s._v(" 创建标签，然后再执行推送命令，因为推送时没有指定推送到哪个标签，所有默认会选择最后创建的标签进行推送。")]),s._v(" "),t("div",{staticClass:"language-powershell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[s._v("E:\\Pro\\Docker\\app>docker tag getting"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("started marklin9"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("getting"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("started\n\nE:\\Pro\\Docker\\app>docker push marklin9"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("getting"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("started\nThe push refers to repository "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[docker.io/marklin9/getting-started]")]),s._v("\n84209d609ad4: Pushing "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("====================>                 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  34"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("91MB"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("85"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("22MB\n1c47c11619a7: Pushed\n1838377223c6: Pushed\n6693766656f0: Pushed\nab2b28314466: Pushed\n62d0a87660b8: Mounted "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" library"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("node\n0fcbbeeeb0d7: Mounted "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" library"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("node\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("等待推送成功即可。")])])])])}),[],!1,null,null,null);e.default=r.exports}}]);